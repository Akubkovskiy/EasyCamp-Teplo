# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é EasyCamp Bot

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (Ubuntu/Debian)

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã Git, Docker –∏ Docker Compose.

```bash
# –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º—É
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Git –∏ Docker
sudo apt install -y git docker.io docker-compose

# –í–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ Docker
sudo systemctl enable --now docker
```

## 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–∑–∞–º–µ–Ω–∏—Ç–µ URL –Ω–∞ –≤–∞—à)
git clone <–í–ê–®_–†–ï–ü–û–ó–ò–¢–û–†–ò–ô> easycamp-bot
cd easycamp-bot

# 2. –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
mkdir -p data logs

# 3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç—É–¥–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∞—à–µ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ .env
nano .env

# 4. –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö Google
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à google-credentials.json –≤ –ø–∞–ø–∫—É —Å –±–æ—Ç–æ–º
# (–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sftp, scp –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –∏ –≤—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç)
# ‚ö†Ô∏è –í–ê–ñ–ù–û: –í–∫–ª—é—á–∏—Ç–µ Google Drive API –≤ –∫–æ–Ω—Å–æ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã –±—ç–∫–∞–ø–æ–≤!
nano google-credentials.json
```

## 3. –ó–∞–ø—É—Å–∫

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
sudo docker-compose up -d --build

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
sudo docker-compose logs -f

# üöë –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å Up)
docker ps

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
docker logs --tail 50 easycamp_bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
docker-compose restart
```

## 4. –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏
```bash
git pull
sudo docker-compose up -d --build
```

### –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ `data/easycamp.db` –Ω–∞ —Ö–æ—Å—Ç–µ.
–í—ã –º–æ–∂–µ—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–ª—è –±—ç–∫–∞–ø–∞.

```bash
cp data/easycamp.db data/easycamp_backup_$(date +%Y%m%d).db
```

### –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
```bash
sudo docker-compose restart
```

## 5. Rate Limiting (Rate Limit)

Webhook `/avito/webhook` –∑–∞—â–∏—â—ë–Ω rate limiting (30 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç–∞ –Ω–∞ IP –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).

### ‚ö†Ô∏è –í–∞–∂–Ω–æ: –†–∞–±–æ—Ç–∞ –∑–∞ reverse proxy (nginx/Cloudflare)

–ï—Å–ª–∏ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ nginx –∏–ª–∏ Cloudflare, –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —Å –æ–¥–Ω–æ–≥–æ IP –ø—Ä–æ–∫—Å–∏.
–≠—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –ª–æ–∂–Ω—ã–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ forwarded headers –≤ nginx:
   ```nginx
   proxy_set_header X-Real-IP $remote_addr;
   proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
   ```

2. –ò–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ rate limit:
   ```bash
   RATE_LIMIT_ENABLED=false
   ```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏
```bash
RATE_LIMIT_ENABLED=true      # Killswitch
RATE_LIMIT_WEBHOOK=30/minute # –õ–∏–º–∏—Ç (–º–æ–∂–Ω–æ: 10/second, 100/hour –∏ —Ç.–¥.)
```
